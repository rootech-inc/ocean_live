{% extends 'retail/base.html' %}
{% load static %}
{% block body %}

    <div class="table-responsive">
        <table id="table" class="table table-striped table-bordered table-hover table-sm">
            <thead>
                <tr>
                    <th>BARCODE</th><th>NAME</th><th>PRICE</th>
                </tr>
            </thead>
            <tbody id="tbody">
                <tr>
                    <td colspan="3" class="text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        async function getWhSales() {
            let payload = {
                module: 'wholesale_prices',
                data: {}
            }

            await api.v2('VIEW', payload, '/retail/api/').then(res => {
                if(anton.IsRequest(res)){
                    let tr = ""
                    res.message.forEach(item => {
                        tr += `<tr>
                            <td>${item.barcode}</td>
                            <td>${item.name}</td>
                            <td>${item.price}</td>
                        </tr>`
                    })
                    $('#tbody').html(tr)
                    $('#table').DataTable()
                } else {
                    kasa.response(res)
                }
            }).catch(err => {
                kasa.error(err)
            })
        }

        $(document).ready(function(){
            getWhSales();
        })
    </script>
{% endblock %}